  METHOD z270cadprodutoss_create_entity.

    DATA: ls_cadprodutos TYPE z270cadprodutos.
    DATA(lv_container) = mo_context->get_message_container( ).

    io_data_provider->read_entry_data(
      IMPORTING
        es_data = er_entity
    ).

    MOVE-CORRESPONDING er_entity TO ls_cadprodutos.

    " Trartr erro descrição VAZIA
    IF ls_cadprodutos-descricao = ''.

      lv_container->add_message_text_only(
        EXPORTING
          iv_msg_type               = 'E'
          iv_msg_text               = 'Descrição vazia'
          iv_is_leading_message     = abap_true
          iv_add_to_response_header = abap_true ).

      RAISE EXCEPTION TYPE /iwbep/cx_mgw_busi_exception
        EXPORTING
          message_container = lv_container.

    ENDIF.

    SELECT MAX( codigo ) FROM z270cadprodutos INTO ls_cadprodutos-codigo.
    ADD 1 TO ls_cadprodutos-codigo.

    " Validar cadastro repetido
    SELECT COUNT( * )
      FROM z270cadprodutos
      WHERE descricao = ls_cadprodutos-descricao.

    IF sy-subrc = 0.
      " ERRO. Sair.
      lv_container->add_message_text_only(
        EXPORTING
          iv_msg_type               = 'E'
          iv_msg_text               = 'Produto já existe !'
          iv_is_leading_message     = abap_true
          iv_add_to_response_header = abap_true ).

      RAISE EXCEPTION TYPE /iwbep/cx_mgw_busi_exception
        EXPORTING
          message_container = lv_container.

    ENDIF.

    IF ls_cadprodutos-meins = ''.
      ls_cadprodutos-meins = 'KG'.
    ENDIF.
    IF ls_cadprodutos-waerk = ''.
      ls_cadprodutos-waerk = 'BRL'.
    ENDIF.

    INSERT z270cadprodutos FROM ls_cadprodutos.

    IF sy-subrc = 0.

      er_entity-codigo = ls_cadprodutos-codigo.

      lv_container->add_message_text_only(
        EXPORTING
          iv_msg_type               = 'S'
          iv_msg_text               = 'Produto criado com sucesso !'
          iv_is_leading_message     = abap_true
          iv_add_to_response_header = abap_true ).

    ELSE.

      lv_container->add_message_text_only(
        EXPORTING
          iv_msg_type               = 'E'
          iv_msg_text               = 'Erro ao Inserir Produto na Tabela !'
          iv_is_leading_message     = abap_true
          iv_add_to_response_header = abap_true ).

      RAISE EXCEPTION TYPE /iwbep/cx_mgw_busi_exception
        EXPORTING
          message_container = lv_container.

    ENDIF.

  ENDMETHOD.