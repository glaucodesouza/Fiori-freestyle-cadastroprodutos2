  METHOD /iwbep/if_mgw_appl_srv_runtime~changeset_process.

    DATA:
      lv_operation_counter  TYPE i VALUE 0,
      lr_context            TYPE REF TO /iwbep/cl_mgw_request,
      lr_entry_provider     TYPE REF TO /iwbep/if_mgw_entry_provider,
      lr_message_container  TYPE REF TO /iwbep/if_message_container,
      lr_entity_data        TYPE REF TO data,
      ls_context_details    TYPE /iwbep/if_mgw_core_srv_runtime=>ty_s_mgw_request_context,
      ls_changeset_response LIKE LINE OF ct_changeset_response.

    FIELD-SYMBOLS:
        <fs_ls_changeset_request>  LIKE LINE OF it_changeset_request.

    DATA(lv_container) = mo_context->get_message_container( ).

    LOOP AT it_changeset_request ASSIGNING <fs_ls_changeset_request>.
      lr_context          ?= <fs_ls_changeset_request>-request_context.
      lr_entry_provider    = <fs_ls_changeset_request>-entry_provider.
      lr_message_container = <fs_ls_changeset_request>-msg_container.
      ls_context_details   = lr_context->get_request_details( ).
      CASE ls_context_details-target_entity.
        WHEN 'Z270CADPRODUTOS'.
          "Do the processing here
          IF line_exists( ls_context_details-key_tab[ 1 ] ).
            IF ls_context_details-key_tab[ 1 ]-name = 'Codigo'.
              DATA(lv_codigo) = ls_context_details-key_tab[ 1 ]-value.
              SELECT SINGLE * FROM z270cadprodutos
                INTO @DATA(ls_z270cadprodutos)
                WHERE codigo = @lv_codigo.
              IF sy-subrc = 0.
                DELETE z270cadprodutos FROM ls_z270cadprodutos.
                IF sy-subrc = 0.

                  copy_data_to_ref(
                      EXPORTING
                        is_data = ls_z270cadprodutos
                      CHANGING
                        cr_data = ls_changeset_response-entity_data ).

                  ls_changeset_response-operation_no = <fs_ls_changeset_request>-operation_no.
                  INSERT ls_changeset_response INTO TABLE ct_changeset_response.
                ELSE.
                  " ERRO. Sair.
                  lv_container->add_message_text_only(
                    EXPORTING
                      iv_msg_type               = 'E'
                      iv_msg_text               = 'Erro ao deletar'
                      iv_is_leading_message     = 'X'
                      iv_add_to_response_header = 'X' ).

                  DATA(lv_erro) = 'X'.
                  RAISE EXCEPTION TYPE /iwbep/cx_mgw_busi_exception
                    EXPORTING
                      message_container = lv_container.
                ENDIF.
              ENDIF.
            ENDIF.
          ENDIF.
        WHEN OTHERS.
      ENDCASE.
    ENDLOOP.

    IF lv_erro = 'X'.
      RAISE EXCEPTION TYPE /iwbep/cx_mgw_busi_exception
        EXPORTING
          message_container = lv_container.
    ENDIF.

  ENDMETHOD.